<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Interactions - Alloverse Documentation</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Interactions | Alloverse Documentation</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Interactions" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Getting started with Alloverse. Guides, code snippets, API references…" /> <meta property="og:description" content="Getting started with Alloverse. Guides, code snippets, API references…" /> <link rel="canonical" href="/protocol-reference/interactions" /> <meta property="og:url" content="/protocol-reference/interactions" /> <meta property="og:site_name" content="Alloverse Documentation" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Interactions" /> <script type="application/ld+json"> {"description":"Getting started with Alloverse. Guides, code snippets, API references…","url":"/protocol-reference/interactions","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/Alloverse01.png"}},"headline":"Interactions","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Get Started</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/concepts" class="nav-list-link">Concepts</a><ul class="nav-list "><li class="nav-list-item "><a href="/concepts/architecture" class="nav-list-link">Alloverse Architecture</a></li><li class="nav-list-item "><a href="/concepts/points-pokes-and-grabs" class="nav-list-link">Points, Pokes and Grabs</a></li><li class="nav-list-item "><a href="/concepts/writing-apps-with-alloUI" class="nav-list-link">Writing apps with AlloUI</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/examples" class="nav-list-link">Examples</a><ul class="nav-list "><li class="nav-list-item "><a href="/concepts/animating-views" class="nav-list-link">Animating Views</a></li><li class="nav-list-item "><a href="/concepts/assets" class="nav-list-link">Assets</a></li></ul></li><li class="nav-list-item"><a href="/hig" class="nav-list-link">3D Human Interface Guidelines</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/classes/" class="nav-list-link">Classes</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="/modules/" class="nav-list-link">Modules</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/protocol-reference" class="nav-list-link">Protocol Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/protocol-reference/asset-protocols" class="nav-list-link">Asset Protocol</a></li><li class="nav-list-item "><a href="/protocol-reference/coordinate-system" class="nav-list-link">Coordinate System</a></li><li class="nav-list-item "><a href="/protocol-reference/identity" class="nav-list-link">Identity</a></li><li class="nav-list-item "><a href="/protocol-reference/intent" class="nav-list-link">Intent</a></li><li class="nav-list-item active"><a href="/protocol-reference/interactions" class="nav-list-link active">Interactions</a></li><li class="nav-list-item "><a href="/protocol-reference/official-components" class="nav-list-link">Official Components</a></li><li class="nav-list-item "><a href="/protocol-reference/state-diffs" class="nav-list-link">State Diffs</a></li><li class="nav-list-item "><a href="/protocol-reference/url-definitions" class="nav-list-link">URL Definitions</a></li><li class="nav-list-item "><a href="/protocol-reference/wire-protocol" class="nav-list-link">Wire Protocol</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/community" class="nav-list-link">Community</a><ul class="nav-list "><li class="nav-list-item "><a href="/community/contributing" class="nav-list-link">Contributing to Alloverse</a></li><li class="nav-list-item "><a href="/community/code-of-conduct.html" class="nav-list-link">Code of Conduct</a></li><li class="nav-list-item "><a href="/community/licenses" class="nav-list-link">Licenses used by Alloverse</a></li><li class="nav-list-item "><a href="/community/alloverse-license.html" class="nav-list-link">Alloverse License</a></li></ul></li><li class="nav-list-item"><a href="/doc/classes/Asset.html" class="nav-list-link">Asset</a></li><li class="nav-list-item"><a href="/doc/classes/AssetManager.html" class="nav-list-link">AssetManager</a></li><li class="nav-list-item"><a href="/doc/classes/AssetView.html" class="nav-list-link">AssetView</a></li><li class="nav-list-item"><a href="/doc/classes/Base64Asset.html" class="nav-list-link">Base64Asset</a></li><li class="nav-list-item"><a href="/doc/classes/Button.html" class="nav-list-link">Button</a></li><li class="nav-list-item"><a href="/doc/classes/FileAsset.html" class="nav-list-link">FileAsset</a></li><li class="nav-list-item"><a href="/doc/classes/GrabHandle.html" class="nav-list-link">GrabHandle</a></li><li class="nav-list-item"><a href="/doc/" class="nav-list-link">Index</a></li><li class="nav-list-item"><a href="/doc/classes/Label.html" class="nav-list-link">Label</a></li><li class="nav-list-item"><a href="/doc/classes/Speaker.html" class="nav-list-link">Speaker</a></li><li class="nav-list-item"><a href="/doc/classes/Surface.html" class="nav-list-link">Surface</a></li><li class="nav-list-item"><a href="/doc/classes/TextField.html" class="nav-list-link">TextField</a></li><li class="nav-list-item"><a href="/doc/classes/View.html" class="nav-list-link">View</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.assetstore.html" class="nav-list-link">allonet.include.allonet.assetstore</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.client.html" class="nav-list-link">allonet.include.allonet.client</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.jobs.html" class="nav-list-link">allonet.include.allonet.jobs</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.state.html" class="nav-list-link">allonet.include.allonet.state</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.lang.lua.allonet-lua.html" class="nav-list-link">allonet.lang.lua.allonet-lua</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.lang.lua.json.html" class="nav-list-link">allonet.lang.lua.json</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.lang.lua.lua-utils.html" class="nav-list-link">allonet.lang.lua.lua-utils</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.asset.html" class="nav-list-link">allonet.src.asset</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.assetstore.html" class="nav-list-link">allonet.src.assetstore</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.client.audio.html" class="nav-list-link">allonet.src.client.audio</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.clientproxy.html" class="nav-list-link">allonet.src.clientproxy</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.delta.html" class="nav-list-link">allonet.src.delta</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.server.html" class="nav-list-link">allonet.src.server</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.test.assetstore_test.html" class="nav-list-link">allonet.test.assetstore_test</a></li><li class="nav-list-item"><a href="/doc/modules/alloui.lua.alloui.json.html" class="nav-list-link">alloui.lua.alloui.json</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Alloverse Documentation" aria-label="Search Alloverse Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/protocol-reference">Protocol Reference</a></li> <li class="breadcrumb-nav-list-item"><span>Interactions</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="interactions"> <a href="#interactions" class="anchor-heading" aria-labelledby="interactions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Interactions </h1> <p>For an overview of what an interaction is, please see <a href="README.md">README.md</a>.</p> <p>These interactions are defined by alloserv. Third party developers may create any interactions they want. They can vote to make their own interactions official by opening an issue on this repo.</p> <h2 id="agent-announce"> <a href="#agent-announce" class="anchor-heading" aria-labelledby="agent-announce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Agent announce </h2> <p>After an agent connects, before it can interact with the place it must announce itself and spawn its avatar entity. Failure to announce will lead to force disconnect.</p> <ul> <li>Receiver: <code class="language-plaintext highlighter-rouge">place</code></li> <li>Type: <code class="language-plaintext highlighter-rouge">request</code></li> <li>Request body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "announce",
  "version",
  1,
  "identity",
  {
    // identity body goes here
  },
  "spawn_avatar",
  {
    // same as "spawn_entity" key in "Agent requests to spawn entity"
  }
]
</code></pre></div></div> <ul> <li>Response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "announce",
  "{ID of avatar entity}",
  "{name of place}"
]
</code></pre></div></div> <h2 id="spawn-entity"> <a href="#spawn-entity" class="anchor-heading" aria-labelledby="spawn-entity"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Spawn entity </h2> <ul> <li>Receiver: <code class="language-plaintext highlighter-rouge">place</code></li> <li>Type: <code class="language-plaintext highlighter-rouge">request</code></li> <li>Request body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "spawn_entity",
  {
    // list of initial values for components for new entity goes here

    "children": [
      // list of new child entities to create; same body as for "spawn_entity".
      // These will automatically get a "relationships" component set up referencing
      // the parent entity.
      {
        // list of initial values for components for child of new entity goes here
      },
      ...
    ]
  }
]
</code></pre></div></div> <ul> <li>Response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "spawn_entity",
  "{ID of entity if spawned}"
]
</code></pre></div></div> <h2 id="remove-entity"> <a href="#remove-entity" class="anchor-heading" aria-labelledby="remove-entity"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Remove entity </h2> <ul> <li>Receiver: <code class="language-plaintext highlighter-rouge">place</code></li> <li>Type: <code class="language-plaintext highlighter-rouge">request</code></li> <li>Request body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "remove_entity",
  "{ID of entity to remove}",
  "{'reparent' or 'cascade'}"
]
</code></pre></div></div> <ul> <li>Reparent: If the removed entity has children, they will be reparented to root</li> <li> <p>Cascade: If the removed entity has children, they will also be removed.</p> </li> <li>Response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "remove_entity",
  "ok"
]
</code></pre></div></div> <h2 id="changeaddremove-components-in-entity"> <a href="#changeaddremove-components-in-entity" class="anchor-heading" aria-labelledby="changeaddremove-components-in-entity"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Change/add/remove component(s) in entity </h2> <ul> <li>Receiver: <code class="language-plaintext highlighter-rouge">place</code></li> <li>Type: <code class="language-plaintext highlighter-rouge">request</code></li> <li>Request body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "change_components",
  "{entity ID}",
  "add_or_change",
  {
    // object with new values for components (regardless of if
    // component already exists on entity)
  }
  "remove",
  [
    // keys of components to remove
  ]
]
</code></pre></div></div> <p>Response:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "change_components",
  "ok"
]
</code></pre></div></div> <p>A default ACL rule is set so that you must own the entity whose component you’re changing, but this rule can be changed.</p> <h2 id="subscribeunsubscribe"> <a href="#subscribeunsubscribe" class="anchor-heading" aria-labelledby="subscribeunsubscribe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Subscribe/unsubscribe </h2> <ul> <li>Receiver: <code class="language-plaintext highlighter-rouge">place</code></li> <li>Type: <code class="language-plaintext highlighter-rouge">request</code></li> <li>Request body for subscribe:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "subscribe",
  """{guard pattern}"""
]
</code></pre></div></div> <ul> <li>Response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "subscribe",
  "{subscription ID}"
]
</code></pre></div></div> <ul> <li>Unsubscribe request body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "unsubscribe",
  "{subscription ID}"
]
</code></pre></div></div> <ul> <li>Response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "unsubscribe",
  "{'ok'|'not_subscribed'}"
]
</code></pre></div></div> <ul> <li>Example:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [
    "interaction",
    "request",
    "1234",
    "place", // place is the subscription gateway
    "567",
    [
      "subscribe",
      """[
        "new_tweet",
        TweetSender,
        TweetBody
      ] where TweetSender == "nevyn" """
    ]
</code></pre></div></div> <p>In this scenario the place contains an app that publishes new tweets as interactions to the room. This interaction will ask the place to subscribe to all interaction publications which start with the word “new_tweet” followed by two fields. The guard clause asks that the sender must be “nevyn”. If the guard matches, the publication interaction will be forwarded by the place from the sending agent to the subscribing agent.</p> <h2 id="modify-acl"> <a href="#modify-acl" class="anchor-heading" aria-labelledby="modify-acl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Modify ACL </h2> <h2 id="entity-points-at-another-entity"> <a href="#entity-points-at-another-entity" class="anchor-heading" aria-labelledby="entity-points-at-another-entity"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Entity points at another entity </h2> <p>An entity, most likely the avatar of a user, is pointing with their finger at another entity. This is used as a precursor to actually interacting with it (“poking it”).</p> <p>The interaction describes two points in world space: the tip of the finger, and the intersection point between the ray from the finger and the nearest entity, so that the entity can know <em>where</em> on itself someone is pointing.</p> <ul> <li>Receiver: The pointed-at entity</li> <li>Type: <code class="language-plaintext highlighter-rouge">one-way</code></li> <li>Body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "point",
  [1.0, 2.0, 3.0], // finger tip in world space coordinates
  [4.0, 5.0, 6.0], // intersection point in world space coordinates
]
</code></pre></div></div> <p>If the ray cast from the user’s finger veers off the last pointed-at entity, one last message is sent to indicate that the user has stopped pointing at it. This is useful for removing highlight effect, etc.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "point-exit"
]
</code></pre></div></div> <h2 id="entity-pokes"> <a href="#entity-pokes" class="anchor-heading" aria-labelledby="entity-pokes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Entity pokes </h2> <p>Once an entity is pointing at another entity, it can ask to “physically” interact with it, by turning the pointing into a poke. The poke doesn’t contain vector information – it’s up to the receiver to correlate with pointing events, as those will be streaming a continuously updating location, while poking is a request-response which the receiver can reject. Such a rejection should be visualized, so that the sender’s user can understand if and why poking failed.</p> <ul> <li>Receiver: The pointed-at entity</li> <li>Type: <code class="language-plaintext highlighter-rouge">request</code></li> <li>Request body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "poke",
  {true|false} // whether poking started (true) or stopped (false)
]
</code></pre></div></div> <ul> <li>Success response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "poke",
  "ok"
]
</code></pre></div></div> <ul> <li>Failure response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "poke",
  "failed",
  "{string explaining why, presentable to user}"
]
</code></pre></div></div> <h2 id="entity-wishes-to-transmit-live-media"> <a href="#entity-wishes-to-transmit-live-media" class="anchor-heading" aria-labelledby="entity-wishes-to-transmit-live-media"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Entity wishes to transmit live media </h2> <p>Before an entity can transmit streamed audio, video or geometry, a track must be created along which to send that data. This interaction will add a <a href="official-components#live-media">live_media</a> component to the sender’s entity.</p> <p>Only audio, and only mono opus, is supported right now.</p> <ul> <li>Receiver: <code class="language-plaintext highlighter-rouge">place</code></li> <li>Type: <code class="language-plaintext highlighter-rouge">request</code></li> <li>Request body:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "allocate_track",
  "audio", # media type
  48000, # sample rate
  1, # channel count
  "opus" # media format
]
</code></pre></div></div> <ul> <li>Success response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "allocate_track",
  "ok",
  3 # track_id
]
</code></pre></div></div> <ul> <li>Failure response:</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  "allocate_track",
  "failed",
  "{string explaining why, presentable to user}"
]
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
