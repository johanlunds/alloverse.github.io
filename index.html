<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Get Started - Alloverse Documentation</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Get Started | Alloverse Documentation</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Get Started" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Getting started with Alloverse. Guides, code snippets, API references…" /> <meta property="og:description" content="Getting started with Alloverse. Guides, code snippets, API references…" /> <link rel="canonical" href="/" /> <meta property="og:url" content="/" /> <meta property="og:site_name" content="Alloverse Documentation" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Get Started" /> <script type="application/ld+json"> {"description":"Getting started with Alloverse. Guides, code snippets, API references…","url":"/","@type":"WebSite","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/assets/images/Alloverse01.png"}},"headline":"Get Started","name":"Alloverse Documentation","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="/" class="nav-list-link active">Get Started</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/concepts" class="nav-list-link">Concepts</a><ul class="nav-list "><li class="nav-list-item "><a href="/concepts/architecture" class="nav-list-link">Alloverse Architecture</a></li><li class="nav-list-item "><a href="/concepts/points-pokes-and-grabs" class="nav-list-link">Points, Pokes and Grabs</a></li><li class="nav-list-item "><a href="/concepts/writing-apps-with-alloUI" class="nav-list-link">Writing apps with AlloUI</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/examples" class="nav-list-link">Examples</a><ul class="nav-list "><li class="nav-list-item "><a href="/concepts/animating-views" class="nav-list-link">Animating Views</a></li><li class="nav-list-item "><a href="/concepts/assets" class="nav-list-link">Assets</a></li></ul></li><li class="nav-list-item"><a href="/hig" class="nav-list-link">3D Human Interface Guidelines</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/classes/" class="nav-list-link">Classes</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="/modules/" class="nav-list-link">Modules</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/protocol-reference" class="nav-list-link">Protocol Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="/protocol-reference/asset-protocols" class="nav-list-link">Asset Protocol</a></li><li class="nav-list-item "><a href="/protocol-reference/coordinate-system" class="nav-list-link">Coordinate System</a></li><li class="nav-list-item "><a href="/protocol-reference/identity" class="nav-list-link">Identity</a></li><li class="nav-list-item "><a href="/protocol-reference/intent" class="nav-list-link">Intent</a></li><li class="nav-list-item "><a href="/protocol-reference/interactions" class="nav-list-link">Interactions</a></li><li class="nav-list-item "><a href="/protocol-reference/official-components" class="nav-list-link">Official Components</a></li><li class="nav-list-item "><a href="/protocol-reference/state-diffs" class="nav-list-link">State Diffs</a></li><li class="nav-list-item "><a href="/protocol-reference/url-definitions" class="nav-list-link">URL Definitions</a></li><li class="nav-list-item "><a href="/protocol-reference/wire-protocol" class="nav-list-link">Wire Protocol</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/community" class="nav-list-link">Community</a><ul class="nav-list "><li class="nav-list-item "><a href="/community/contributing" class="nav-list-link">Contributing to Alloverse</a></li><li class="nav-list-item "><a href="/community/code-of-conduct.html" class="nav-list-link">Code of Conduct</a></li><li class="nav-list-item "><a href="/community/licenses" class="nav-list-link">Licenses used by Alloverse</a></li><li class="nav-list-item "><a href="/community/alloverse-license.html" class="nav-list-link">Alloverse License</a></li></ul></li><li class="nav-list-item"><a href="/doc/classes/Asset.html" class="nav-list-link">Asset</a></li><li class="nav-list-item"><a href="/doc/classes/AssetManager.html" class="nav-list-link">AssetManager</a></li><li class="nav-list-item"><a href="/doc/classes/AssetView.html" class="nav-list-link">AssetView</a></li><li class="nav-list-item"><a href="/doc/classes/Base64Asset.html" class="nav-list-link">Base64Asset</a></li><li class="nav-list-item"><a href="/doc/classes/Button.html" class="nav-list-link">Button</a></li><li class="nav-list-item"><a href="/doc/classes/FileAsset.html" class="nav-list-link">FileAsset</a></li><li class="nav-list-item"><a href="/doc/classes/GrabHandle.html" class="nav-list-link">GrabHandle</a></li><li class="nav-list-item"><a href="/doc/" class="nav-list-link">Index</a></li><li class="nav-list-item"><a href="/doc/classes/Label.html" class="nav-list-link">Label</a></li><li class="nav-list-item"><a href="/doc/classes/Speaker.html" class="nav-list-link">Speaker</a></li><li class="nav-list-item"><a href="/doc/classes/Surface.html" class="nav-list-link">Surface</a></li><li class="nav-list-item"><a href="/doc/classes/TextField.html" class="nav-list-link">TextField</a></li><li class="nav-list-item"><a href="/doc/classes/View.html" class="nav-list-link">View</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.assetstore.html" class="nav-list-link">allonet.include.allonet.assetstore</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.client.html" class="nav-list-link">allonet.include.allonet.client</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.jobs.html" class="nav-list-link">allonet.include.allonet.jobs</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.include.allonet.state.html" class="nav-list-link">allonet.include.allonet.state</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.lang.lua.allonet-lua.html" class="nav-list-link">allonet.lang.lua.allonet-lua</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.lang.lua.json.html" class="nav-list-link">allonet.lang.lua.json</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.lang.lua.lua-utils.html" class="nav-list-link">allonet.lang.lua.lua-utils</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.asset.html" class="nav-list-link">allonet.src.asset</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.assetstore.html" class="nav-list-link">allonet.src.assetstore</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.client.audio.html" class="nav-list-link">allonet.src.client.audio</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.clientproxy.html" class="nav-list-link">allonet.src.clientproxy</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.delta.html" class="nav-list-link">allonet.src.delta</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.src.server.html" class="nav-list-link">allonet.src.server</a></li><li class="nav-list-item"><a href="/doc/modules/allonet.test.assetstore_test.html" class="nav-list-link">allonet.test.assetstore_test</a></li><li class="nav-list-item"><a href="/doc/modules/alloui.lua.alloui.json.html" class="nav-list-link">alloui.lua.alloui.json</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Alloverse Documentation" aria-label="Search Alloverse Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="get-started"> <a href="#get-started" class="anchor-heading" aria-labelledby="get-started"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Get Started </h1> <p>Alloverse is an open platform for collaborative workspaces in 3D. It’s Gibson style Cyberspace, but for your day-to-day work and play, with your friends and colleagues. It’s a VR and AR platform for creating spaces, and for running real applications within those spaces, together with other people.</p> <p>Please see the public website for more information.</p> <p>In nerd terms, it’s a VR/AR/3D “window manager” and collaborative workspace.</p> <p>Your “place” is where you decorate, run apps, invite people, and hang out. It’s like a collaborative X11 server: It runs a world simulation server, a voip gateway, and all the backing data for 3d UIs for the running apps. The reference Elixir implementation is in alloplace. A “visor” is the GUI application you use to visit places and interact with your apps. allovisor implements such a visor for VR in Unity. An “appliance” is a process running on your computer, or on a computer on the Internet. Like opening a web page (or launching a remote X11 process), this app can then show its interface and be interacted with inside your place. The network and “UI protocol” is abstracted into the allonet library, written in C and used by all the above projects.</p> <h2 id="developing-an-alloverse-app"> <a href="#developing-an-alloverse-app" class="anchor-heading" aria-labelledby="developing-an-alloverse-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Developing an Alloverse App </h2> <p>An Alloverse app is a server-side app that you run on your own server, similarly to how you would host a web app on your own server. The difference is, when a user goes to your app on the web, it loads into that user’s web browser on their computer; but when a user goes to your alloapp in an Alloverse Place, the app loads into the Place for all users in that Place to use, and your code gets collaboration and VR super-powers for free.</p> <p>This tutorial will take you through creating an Alloverse app using the Lua programming language, since that is the language we’ve developed the most support for so far.</p> <p>You can build apps on Mac, Linux or Windows; but for the latter, you’ll need a Unix shell, e g mingw, msys2 or WSL.</p> <p>In contrast to a web framework like Rails or Django, Alloverse doesn’t install any software onto your system. Instead, a project is completely self-contained within its project folder, and contains everything it needs to run.</p> <h2 id="creating-your-project"> <a href="#creating-your-project" class="anchor-heading" aria-labelledby="creating-your-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating your project </h2> <p>First, create a project folder. Allo Assist requires Git to fetch all its dependencies, so we’ll init a Git repo in the folder. Then we can initialize the alloapp environment into it, and make sure it works:</p> <figure class="highlight"><pre><code class="language-terminal" data-lang="terminal"><span class="gp">$</span><span class="w"> </span><span class="nb">mkdir </span>allo-todo
<span class="gp">$</span><span class="w"> </span><span class="nb">cd </span>allo-todo
<span class="gp">$</span><span class="w"> </span>git init
<span class="gp">$</span><span class="w"> </span>/bin/bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/alloverse/alloapp-assist/master/setup.bash<span class="si">)</span><span class="s2">"</span>
<span class="gp">$</span><span class="w"> </span>./allo/assist <span class="nb">help</span></code></pre></figure> <p>(This is also a good time to <code class="language-plaintext highlighter-rouge">git commit -a</code>, so the next commit only contains your own changes.)</p> <p>The curl’d script will have created this project structure for you:</p> <ul> <li><code class="language-plaintext highlighter-rouge">lua</code> contains the Lua source code for your app <ul> <li><code class="language-plaintext highlighter-rouge">lua/main.lua</code> contains your app! It barely does anything yet. But you can add more code to this file to keep going, and add more files into lua to modularize your code.</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">images</code> contains images you want to use as textures on buttons, etc.</li> <li><code class="language-plaintext highlighter-rouge">allo</code> contains the Alloverse app framework. You should not edit anything in here, as an upgrade of the framework will overwrite your changes. <ul> <li><code class="language-plaintext highlighter-rouge">allo/assist</code> is a script that helps you with tasks such as starting a server, installing dependencies, etc…</li> <li><code class="language-plaintext highlighter-rouge">allo/libs</code> contains compiled C dependencies as dynamic libraries and executables. These are <code class="language-plaintext highlighter-rouge">.gitignore</code>d to save space. If you check out your code on another computer, you can <code class="language-plaintext highlighter-rouge">./allo/assist fetch</code> to install them again, so you don’t need to (and shouldn’t) commit them.</li> <li><code class="language-plaintext highlighter-rouge">allo/boot.lua</code> sets up the runtime environment for your app. This code is generated, so it’s not recommended to modify this file.</li> </ul> </li> </ul> <h2 id="trying-your-app-out"> <a href="#trying-your-app-out" class="anchor-heading" aria-labelledby="trying-your-app-out"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Trying your app out </h2> <p>That’s it! You should now be able to start your project and see it appear in an Alloplace. If you don’t have one already, you can get or rent a Place at <a href="places.alloverse.com/">places.alloverse.com</a>, boot one on your own (<code class="language-plaintext highlighter-rouge">docker run -e ALLOPLACE_NAME="my place" -p 21337:21337/udp -it alloverse/alloplace</code>), or just use our playground <a href="alloplace://nevyn.places.alloverse.com/">alloplace://nevyn.places.alloverse.com</a>. I’m gonna do the latter:</p> <figure class="highlight"><pre><code class="language-terminal" data-lang="terminal"><span class="gp">$</span><span class="w"> </span>./allo/assist run alloplace://nevyn.places.alloverse.com</code></pre></figure> <p>If it all checks out, you should be able to jump into that place on your VR headset and press the button it has created.</p> <p><a href="https://alloverse.com/download/">Download the Visor app for your VR or desktop platform of choice</a>, and then click “Connect”, “Nevyn’s place” (or click the alloplace link of the place you’ve rented or started yourself).</p> <p><img src="/assets/images/hello-world-1024x318.jpg" alt="On the left, the UI of our app shown as a white rectangle with an orange button. On the right, a terminal showing the assist run command that instantiates the app; and the word Hello printed thrice." title="Hello world running inside Alloverse" /> Our app running in Nevyn’s place. I’ve clicked our simple app’s orange button button three times, and the laws of causality held up, printing “Hello” thrice to our terminal.</p> <p>At this point, you could go off, do your own thing, read the documentation as you go. Or you could keep reading, and be guided through the development of a simple but functional todo list app, which will help establish the fundamentals and make it much easier for you to build real, complex apps.</p> <p>This is also a good point at which to remind you: if you get stuck, or have questions or feedback, <a href="https://discord.gg/KhdMU6P6Uw">please do hop on Discord</a> and give it to us straight.</p> <h2 id="anatomy-of-hello-world-in-the-alloverse"> <a href="#anatomy-of-hello-world-in-the-alloverse" class="anchor-heading" aria-labelledby="anatomy-of-hello-world-in-the-alloverse"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Anatomy of Hello World in the Alloverse </h2> <p>Let’s open up <code class="language-plaintext highlighter-rouge">lua/main.lua</code> and have a look at the code, to understand what’s going on. If you’re not much for theory and you’d rather learn by doing, you can <a href="#building-our-app">skip this section and dig directly into making an app</a>.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span>
    <span class="n">arg</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
    <span class="s2">"allo-todo2"</span>
<span class="p">)</span>
<span class="kd">local</span> <span class="n">app</span> <span class="o">=</span> <span class="n">App</span><span class="p">(</span><span class="n">client</span><span class="p">)</span></code></pre></figure> <p>Above, we’re using a <a href="/doc/classes/Client.html">Client</a> to connect this app to a Place. <code class="language-plaintext highlighter-rouge">arg[2]</code> is the URL of the place to connect to, which Assist sets up for you in boot.lua. <a href="/doc/classes/App.html">App</a> then manages the Client connection for you, and manages the lifetime of your app.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">assets</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">quit</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Asset</span><span class="p">.</span><span class="n">File</span><span class="p">(</span><span class="s2">"images/quit.png"</span><span class="p">),</span>
<span class="p">}</span>
<span class="n">app</span><span class="p">.</span><span class="n">assetManager</span><span class="p">:</span><span class="n">add</span><span class="p">(</span><span class="n">assets</span><span class="p">)</span></code></pre></figure> <p>Assets are files (images, glb models, videos, sounds, etc…) that you want to use in your app. They need to be published so that user’s headsets can download them before you can use them. We make <code class="language-plaintext highlighter-rouge">assets</code> global so you can use it throughout your app.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">mainView</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">))</span>
<span class="n">mainView</span><span class="p">.</span><span class="n">grabbable</span> <span class="o">=</span> <span class="kc">true</span></code></pre></figure> <p>Your application is represented by a hierarchy of views. If you’re a web developer, you can think of it as nested elements in a DOM. If you come from Unity, it’s similar to the GameObject hierarchy, with transforms being relative to parent GameObjects. If you’re an oldschool Macintosh Toolbox developer, I’m sorry.</p> <p><code class="language-plaintext highlighter-rouge">app.mainView</code> is the main UI for your app. You should set it up with your main user interface before connecting to the Place.</p> <p><code class="language-plaintext highlighter-rouge">Bounds</code> is the position and size of your object:</p> <ul> <li>The first three numbers are the x, y and z position (<a href="/protocol-reference/coordinate-system">see coordinate space reference</a>), and in this case they mean this view is centered horizontally; its base is 1.2 meters up from the floor; and -2 means 2 meters into the Place, depth-wise.</li> <li>The second group of three numbers is the width, depth and height. Here, we’re 1 meter wide, half a meter wide, and one centimeter deep.</li> </ul> <p>We also make the main view <code class="language-plaintext highlighter-rouge">grabbable</code>, so the user can move it around the Place. Alternatively, you can add a GrabHandle, which acts like the title bar of a desktop UI’s window.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">button</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">))</span>
<span class="n">mainView</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
<span class="n">button</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Hello!"</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure> <p>The standard template has created a standard Button component for you, at 2 decimeters wide and high. Its position of 5 centimeter down and forward is relative to the <code class="language-plaintext highlighter-rouge">mainView</code>’s position.</p> <p>The <code class="language-plaintext highlighter-rouge">onActivated</code> callback lets us run code when the button is pressed. This’ll print “hello” to your local terminal when you run the app on your machine (even if you’re running the visor somewhere else on the Internet!)</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">app</span><span class="p">.</span><span class="n">mainView</span> <span class="o">=</span> <span class="n">mainView</span>
<span class="n">app</span><span class="p">:</span><span class="n">connect</span><span class="p">()</span>
<span class="n">app</span><span class="p">:</span><span class="n">run</span><span class="p">()</span></code></pre></figure> <p>Finally, the template has configured the app’s main view to use this dummy UI. Then, it connects to the Place we’ve been asked to run in, and then hand over the runtime of the app to the UI framework so it keeps running until the user quits it.</p> <p>Now that we got the gist of how to compose an app like this, we can replace it with something useful.</p> <h2 id="building-our-app"> <a href="#building-our-app" class="anchor-heading" aria-labelledby="building-our-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building our app </h2> <p>Let’s make a todo list app! I’m a master artist, so I’ve painted this piece of art to represent our goal:</p> <p><img src="/assets/images/todo-sketch.jpeg" alt="Todo list app sketch" /></p> <p>So we’ve got:</p> <ul> <li>A list of items to check off,</li> <li>A button to add an item</li> <li>A dialog that pops up where you can name your item.</li> </ul> <p>Sounds great. Let’s get started.</p> <p class="label label-green">Note: This is where we start coding for real.</p> <p>Select everything from <code class="language-plaintext highlighter-rouge">local mainView = ...</code> down to <code class="language-plaintext highlighter-rouge">app.mainView = mainView</code> and delete it, and we’ll write some new, fun code.</p> <p>Instead of having a bunch of loose views strewn around the code, I enjoy creating a class for each main container of UI. Some equivalent of a “window”, or “view controller”, or “component” if you will. Let’s create a <code class="language-plaintext highlighter-rouge">TodosView</code>, which will display the list of items, and allow you to quit the app, and add new items.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">class</span><span class="p">.</span><span class="n">TodosView</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Surface</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">_init</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
    <span class="n">self</span><span class="p">:</span><span class="n">super</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">grabbable</span> <span class="o">=</span> <span class="kc">true</span>

    <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span> <span class="o">=</span> <span class="n">self</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span>
      <span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">12</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)</span>
    <span class="p">}))</span>
    <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">:</span><span class="n">setDefaultTexture</span><span class="p">(</span><span class="n">assets</span><span class="p">.</span><span class="n">quit</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
        <span class="n">app</span><span class="p">:</span><span class="n">quit</span><span class="p">()</span>
    <span class="k">end</span>

    <span class="n">self</span><span class="p">.</span><span class="n">addButton</span> <span class="o">=</span> <span class="n">self</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span>
      <span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)</span>
    <span class="p">}))</span>
    <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">label</span><span class="p">:</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Add todo"</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
        <span class="n">self</span><span class="p">:</span><span class="n">showNewTodoPopup</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
    <span class="k">end</span>
    
    <span class="n">self</span><span class="p">.</span><span class="n">todoViews</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">self</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
<span class="k">end</span></code></pre></figure> <p>We’re using <a href="https://stevedonovan.github.io/Penlight/api/libraries/pl.class.html">Penlight’s <code class="language-plaintext highlighter-rouge">class</code> macro</a> to create classes. We inherit <a href="/doc/classes/Surface.html">ui.Surface</a>, which is like a <a href="/doc/classes/View.html">ui.View</a> except it also draws a background, so our app gets a backdrop to rest our controls onto.</p> <p>We create a constructor, where we set up initial state and controls. Here we want a quit <a href="/doc/classes/Button.html">Button</a>, and an add <a href="/doc/classes/Button.html">Button</a>. We immediately add them as subviews to the TodosView, so they show up in the view hierarchy. For the first button, we use one of our image assets as a texture, and for the other, we set the text on the label instead.</p> <p>AlloUI doesn’t have a comprehensive layout system instead, so we’ll call our own <code class="language-plaintext highlighter-rouge">layout</code> at opportune moments. Let’s stub it out so we have something to start with. We’ll also create an instance of it, and use it as our app’s main view:</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
    <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">moveToOrigin</span><span class="p">():</span><span class="n">move</span><span class="p">(</span> <span class="mi">0</span><span class="p">.</span><span class="mi">52</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">25</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">moveToOrigin</span><span class="p">():</span><span class="n">move</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">app</span><span class="p">.</span><span class="n">mainView</span> <span class="o">=</span> <span class="n">TodosView</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">))</span></code></pre></figure> <p>Fire off a quick <code class="language-plaintext highlighter-rouge">./allo/assist run</code> in your terminal, and you’ll be presented with this beauty in VR:</p> <p><img src="/assets/images/todo-progress-1.png" alt="A white surface with a close button in the top right, and an 'add todo' button along the bottom" /></p> <p>We’ve created a VR interface, how cool is that!</p> <p>Next up, let’s create that popup used for inputting new items.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">showNewTodoPopup</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">popup</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)})</span>

    <span class="kd">local</span> <span class="n">input</span> <span class="o">=</span> <span class="n">popup</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">TextField</span><span class="p">{</span>
        <span class="n">bounds</span><span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="kd">local</span> <span class="n">done</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
        <span class="n">self</span><span class="p">:</span><span class="n">addTodo</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">popup</span><span class="p">:</span><span class="n">removeFromSuperview</span><span class="p">()</span>
    <span class="k">end</span>
    <span class="n">input</span><span class="p">.</span><span class="n">onReturn</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
        <span class="n">done</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">false</span>
    <span class="k">end</span>
    <span class="n">input</span><span class="p">:</span><span class="n">askToFocus</span><span class="p">(</span><span class="n">hand</span><span class="p">)</span>

    <span class="kd">local</span> <span class="n">addButton</span> <span class="o">=</span> <span class="n">popup</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">popup</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}))</span>
    <span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
    <span class="n">addButton</span><span class="p">.</span><span class="n">label</span><span class="p">:</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Add"</span><span class="p">)</span>
    <span class="n">addButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="n">done</span>

    <span class="kd">local</span> <span class="n">cancelButton</span> <span class="o">=</span> <span class="n">popup</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">popup</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}))</span>
    <span class="n">cancelButton</span><span class="p">:</span><span class="n">setColor</span><span class="p">({</span><span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">})</span>
    <span class="n">cancelButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
    <span class="n">cancelButton</span><span class="p">.</span><span class="n">label</span><span class="p">:</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Cancel"</span><span class="p">)</span>
    <span class="n">cancelButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
        <span class="n">popup</span><span class="p">:</span><span class="n">removeFromSuperview</span><span class="p">()</span>
    <span class="k">end</span>

    <span class="n">app</span><span class="p">:</span><span class="n">openPopupNearHand</span><span class="p">(</span><span class="n">popup</span><span class="p">,</span> <span class="n">hand</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure> <p>Phew, that’s a handful. Let’s step through it.</p> <ul> <li><code class="language-plaintext highlighter-rouge">popup</code> is our new popup window. It’s another surface, one meter by a half.</li> <li>To it, we add a <a href="/doc/classes/TextField.html">TextField</a>! This is your standard issue text input view. Tapping it will focus it, which will display a virtual keyboard to the user (or if you have a hardware keyboard, you can just use that).</li> <li>We want to close the popup both when the return key is pressed, and when you manually tap the “Add” button, so let’s create a callback we can use for both called <code class="language-plaintext highlighter-rouge">done</code>.</li> <li><code class="language-plaintext highlighter-rouge">onReturn</code> is used to react to return/enter key, and we can also use it to make sure a newline character isn’t added to the text.</li> <li><code class="language-plaintext highlighter-rouge">showNewTodoPopup</code> has been called with a <code class="language-plaintext highlighter-rouge">hand</code>. That’s the hand of the user that tapped the “Add todo button”. It belongs to an avatar, so we can actually ask the avatar if it would pretty please focus this text field, so the user can begin typing in it directly? If you’d be so kind.</li> <li>The <code class="language-plaintext highlighter-rouge">addButton</code> uses the same <code class="language-plaintext highlighter-rouge">done</code> callback as <code class="language-plaintext highlighter-rouge">onReturn</code></li> <li><code class="language-plaintext highlighter-rouge">cancelButton</code> just closes the popup, no questions asked.</li> <li>Finally, <code class="language-plaintext highlighter-rouge">app:openPopupNearHand</code> will display our new fancy popup 60 centimeters away from the user’s hand, which is a convenient distance at which to do your job.</li> </ul> <p class="label label-yellow">Warning: incoming rant</p> <p>The cool thing about this popup is that if you have multiple people in the room, they can all get their own input popup, so they can add their own items without interfering with each other. This is an important and unusual aspect of UI design and development: all your UI is real time collaborative, so you have to consider how your application behaves when multiple people use it at the same time.</p> <p>For example, if you had added the input field directly to the main view, only one user would’ve been able to add items at a time, and they’d likely have interfered with each other’s work. By using a personal popup, users can work naturally collaboratively and in tandem.</p> <p class="label label-green">Relax: rant over.</p> <p>Here’s what this new fancy popup should look like once you tap the “Add todo” button:</p> <p><img src="/assets/images/todo-progress-2.png" alt="A white surface with a text field, an 'add' button, and a 'cancel' button." /></p> <p>Before we continue, we’ll need another asset. Download <img src="/assets/images/checkmark.png" alt="" /> <a href="/assets/images/checkmark.png">checkmark.png</a> and put it in <code class="language-plaintext highlighter-rouge">images/</code>. Update the top of <code class="language-plaintext highlighter-rouge">main.lua</code> to publish this asset:</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="n">assets</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">quit</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Asset</span><span class="p">.</span><span class="n">File</span><span class="p">(</span><span class="s2">"images/quit.png"</span><span class="p">),</span>
    <span class="n">checkmark</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Asset</span><span class="p">.</span><span class="n">File</span><span class="p">(</span><span class="s2">"images/checkmark.png"</span><span class="p">),</span>
<span class="p">}</span></code></pre></figure> <p>Cool. Cool cool cool. Let’s make it actually possible to add todo items, yeah?</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">addTodo</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">todoView</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">View</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">*</span><span class="mi">0</span><span class="p">.</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)})</span>
    
    <span class="kd">local</span> <span class="n">checkButton</span> <span class="o">=</span> <span class="n">todoView</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span><span class="n">size</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">)}))</span>
    <span class="n">checkButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="o">-</span><span class="n">self</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">checkButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">checkButton</span><span class="p">:</span><span class="n">setDefaultTexture</span><span class="p">(</span><span class="n">assets</span><span class="p">.</span><span class="n">checkmark</span><span class="p">)</span>
    <span class="n">checkButton</span><span class="p">.</span><span class="n">onActivated</span> <span class="o">=</span> <span class="k">function</span><span class="p">()</span>
        <span class="n">self</span><span class="p">:</span><span class="n">removeTodo</span><span class="p">(</span><span class="n">todoView</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="kd">local</span> <span class="n">label</span> <span class="o">=</span> <span class="n">todoView</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">ui</span><span class="p">.</span><span class="n">Label</span><span class="p">{</span>
        <span class="n">bounds</span><span class="o">=</span> <span class="n">todoView</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">copy</span><span class="p">():</span><span class="n">inset</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
        <span class="n">halign</span><span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span> <span class="n">text</span>
    <span class="p">})</span>

    <span class="nb">table.insert</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">,</span> <span class="n">todoView</span><span class="p">)</span>
    <span class="n">self</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
    <span class="n">self</span><span class="p">:</span><span class="n">addSubview</span><span class="p">(</span><span class="n">todoView</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">removeTodo</span><span class="p">(</span><span class="n">todoView</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">index</span> <span class="o">=</span> <span class="n">tablex</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">,</span> <span class="n">todoView</span><span class="p">)</span>
    <span class="nb">table.remove</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="n">todoView</span><span class="p">:</span><span class="n">removeFromSuperview</span><span class="p">()</span>
    <span class="n">self</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
<span class="k">end</span></code></pre></figure> <p>This should start to look familiar.</p> <ul> <li><code class="language-plaintext highlighter-rouge">todoView</code> is the parent view of all the controls related to the todo list item. We store them in <code class="language-plaintext highlighter-rouge">self.todoViews</code> so we can layout them properly later.</li> <li><code class="language-plaintext highlighter-rouge">checkButton</code> is used to check off a completed item. We place it along the left edge, tell it to use our new fancy checkmark texture, and configure it to call an as-of-yet nonexistent <code class="language-plaintext highlighter-rouge">removeTodo</code> method.</li> <li><code class="language-plaintext highlighter-rouge">label</code> is the text label describing our item. Text is black (that’s a list of Red, Green, Blue and Alpha, with components from 0.0 to 1.0), horizontally aligned to the left, with the text from the user.</li> <li>We call <code class="language-plaintext highlighter-rouge">layout</code> so our new item is positioned correctly</li> <li>And then we add it as a subview, yay!</li> </ul> <p><code class="language-plaintext highlighter-rouge">removeTodo</code> just finds the given item in the list, and removes it from both the list and the UI, running a relayouting pass to adjust the other items’ positions.</p> <p>That’s awesome! We can now add and remove todo list items! Just one bummer: they all end up stacked on top of each other. We’ll need to lay them out before this is usable. Let’s replace our dummy <code class="language-plaintext highlighter-rouge">layout</code> with something better.</p> <figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="k">function</span> <span class="nf">TodosView</span><span class="p">:</span><span class="n">layout</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">height</span> <span class="o">=</span> <span class="o">#</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span> <span class="o">*</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span>

    <span class="kd">local</span> <span class="n">pen</span> <span class="o">=</span> <span class="n">ui</span><span class="p">.</span><span class="n">Bounds</span><span class="p">{</span>
        <span class="n">size</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">:</span><span class="n">copy</span><span class="p">(),</span>
        <span class="n">pose</span><span class="o">=</span><span class="n">ui</span><span class="p">.</span><span class="n">Pose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">depth</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">pen</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">07</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">addButton</span><span class="p">:</span><span class="n">setBounds</span><span class="p">(</span><span class="n">pen</span><span class="p">:</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">pen</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">todoViews</span><span class="p">)</span> <span class="k">do</span>
        <span class="n">v</span><span class="p">:</span><span class="n">setBounds</span><span class="p">(</span><span class="n">pen</span><span class="p">:</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">pen</span><span class="p">:</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">.</span><span class="n">bounds</span><span class="p">:</span><span class="n">moveToOrigin</span><span class="p">():</span><span class="n">move</span><span class="p">(</span> <span class="mi">0</span><span class="p">.</span><span class="mi">52</span><span class="p">,</span> <span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">025</span><span class="p">)</span>
    <span class="n">self</span><span class="p">.</span><span class="n">quitButton</span><span class="p">:</span><span class="n">setBounds</span><span class="p">()</span>

    <span class="n">self</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">self</span><span class="p">:</span><span class="n">setBounds</span><span class="p">()</span>
<span class="k">end</span></code></pre></figure> <p>Here’s a pattern I’ve brought with me all the way back from building black-and-white Mac apps in the 80s: using a <code class="language-plaintext highlighter-rouge">pen</code> variable which represents a rectangle (or rather, a 3D box!) where we want to “stamp out” our UI, moving the pen as we walk through our items.</p> <ul> <li>We want to adjust the height of our UI to exactly fit our items. Each item is 13 cm tall, and then there’s 25 cm of padding for the “Add todos” button.</li> <li>The add button’s size is a perfect template for our pen. Let’s start the pen at the bottom of the window and lay out controls bottom-to-top, and also move it out from the surface so that our elements sit ON TOP of the surface, instead of embedded in it.</li> <li>Let’s add 7 cm of initial padding</li> <li>There. Stamp the pen’s current state into the add button’s bounds.</li> <li>Add another 15 cm of padding.</li> <li>Stamp the pen onto each todo item view, adding 13 cm of padding for each item.</li> <li>Figure out the perfect new location for the quit button, and…</li> <li>Set the height of the whole app to the one we calculated at the start, and update the bounds so it’s reflected on the users’ headsets.</li> </ul> <p>You know what? I think this is pretty stellar. This’ll do nicely. If you dotted every i, your app should look something like this:</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/49U9tVUoeZU" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> <h2 id="deploying-your-app"> <a href="#deploying-your-app" class="anchor-heading" aria-labelledby="deploying-your-app"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deploying your app </h2> <p>So, you built your fancy VR app. Now you want to show it off, and deploy it so all the Alloverse users in the world can run it in their places, right?</p> <p>Our plan is to provide a Dockerfile which sets everything up just right for you, and an <code class="language-plaintext highlighter-rouge">./allo/assist</code> invocation which deploys it onto Amazon ECS for you. Just a oneliner and it’s deployed. Boom.</p> <p>We haven’t gotten that for yet, though. Watch this space!</p> <h2 id="celebration"> <a href="#celebration" class="anchor-heading" aria-labelledby="celebration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Celebration </h2> <p>If you made it this far, go eat a cinnamon roll, you deserve it. It’s on me. Really, just <a href="https://discord.gg/KhdMU6P6Uw">ping me on Discord</a> and it’s yours. We’d at least love to hear from you, and see your creations.</p> <p>Once you make your own apps, even if you’re not down with cinnamon rolls, do let us know, so we can feature your app in our app browser, blog and tweet about it, etc etc.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
